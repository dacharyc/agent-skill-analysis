{
  "skill_name": "azure-security-keyvault-secrets-java",
  "tasks": [
    {
      "id": "azure-security-keyvault-secrets-java-01",
      "type": "direct_target",
      "prompt": "Write a Java service class that uses the Azure Key Vault Secrets SDK to implement a secret rotation pattern. The class should get the current secret, disable the old version, create a new version with the updated value, and verify the new version is active. Use SecretClient with DefaultAzureCredential and include proper error handling for ResourceNotFoundException and HttpResponseException.",
      "target_language": "java",
      "expected_patterns": [
        "SecretClientBuilder",
        "SecretClient",
        "DefaultAzureCredentialBuilder",
        "setSecret\\(",
        "getSecret\\(",
        "updateSecretProperties\\(",
        "setEnabled\\(false\\)",
        "ResourceNotFoundException",
        "HttpResponseException"
      ],
      "anti_patterns": [
        "SecretClient\\(",
        "from azure\\.keyvault",
        "require.*@azure/keyvault-secrets",
        "secret_client\\.set_secret",
        "secretClient\\.setSecret\\(.*\\{",
        "KeyVaultSecret\\.new"
      ],
      "pattern_sources": [
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclient",
          "description": "Java SecretClient: setSecret, getSecret, updateSecretProperties methods"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclientbuilder",
          "description": "Java SecretClientBuilder: vaultUrl, credential, buildClient pattern"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.identity.defaultazurecredentialbuilder",
          "description": "Java DefaultAzureCredentialBuilder: source of DefaultAzureCredentialBuilder and .build() pattern as required by prompt ('Use SecretClient with DefaultAzureCredential')"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.models.secretproperties",
          "description": "Java SecretProperties: setEnabled(false) for disabling old secret versions"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.core.exception.resourcenotfoundexception",
          "description": "Java ResourceNotFoundException and HttpResponseException for error handling"
        },
        {
          "url": "https://learn.microsoft.com/en-us/python/api/azure-keyvault-secrets/azure.keyvault.secrets.secretclient",
          "description": "Anti-patterns: Python from azure.keyvault, secret_client.set_secret snake_case"
        },
        {
          "url": "https://learn.microsoft.com/en-us/javascript/api/@azure/keyvault-secrets/secretclient",
          "description": "Anti-patterns: JavaScript require @azure/keyvault-secrets"
        }
      ],
      "notes": "Direct Java Key Vault Secrets task matching the skill's rotation pattern. Anti-patterns detect Python SDK (from azure.keyvault, secret_client.set_secret with snake_case), JavaScript SDK (require @azure/keyvault-secrets), and Ruby patterns."
    },
    {
      "id": "azure-security-keyvault-secrets-java-02",
      "type": "cross_language",
      "prompt": "Write a Python script using the azure-keyvault-secrets SDK to list all secrets in a vault, retrieve each enabled secret's value, and export them as environment variables to a .env file. Use DefaultAzureCredential for authentication.",
      "target_language": "python",
      "expected_patterns": [
        "from azure\\.keyvault\\.secrets import SecretClient",
        "from azure\\.identity import DefaultAzureCredential",
        "SecretClient\\(",
        "vault_url=",
        "list_properties_of_secrets",
        "get_secret\\(",
        "\\.value"
      ],
      "anti_patterns": [
        "SecretClientBuilder",
        "\\.buildClient\\(\\)",
        "import com\\.azure",
        "new SecretClientBuilder\\(\\)",
        "listPropertiesOfSecrets\\(\\)",
        "getSecret\\("
      ],
      "pattern_sources": [
        {
          "url": "https://learn.microsoft.com/en-us/python/api/azure-keyvault-secrets/azure.keyvault.secrets.secretclient",
          "description": "Python SecretClient: list_properties_of_secrets, get_secret, vault_url= constructor"
        },
        {
          "url": "https://learn.microsoft.com/en-us/python/api/azure-identity/azure.identity.defaultazurecredential",
          "description": "Python DefaultAzureCredential: direct instantiation without builder"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclientbuilder",
          "description": "Anti-patterns: Java SecretClientBuilder, .buildClient(), listPropertiesOfSecrets camelCase"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclient",
          "description": "Anti-patterns: Java getSecret camelCase method name"
        }
      ],
      "notes": "Python Azure Key Vault SDK is cross-language from the Java skill. Tests whether Java builder patterns (SecretClientBuilder, .buildClient()) and Java method names (listPropertiesOfSecrets, getSecret with camelCase) bleed into Python code which uses snake_case (list_properties_of_secrets, get_secret)."
    },
    {
      "id": "azure-security-keyvault-secrets-java-03",
      "type": "similar_syntax",
      "prompt": "Write a Java application that uses the Azure Key Vault Secrets async client to concurrently retrieve multiple secrets, combine them into a configuration map, and handle errors for individual secret failures without failing the entire operation. Use SecretAsyncClient with reactive patterns.",
      "target_language": "java",
      "expected_patterns": [
        "SecretAsyncClient",
        "buildAsyncClient\\(\\)",
        "subscribe\\(",
        "Mono|Flux|reactor",
        "getSecret\\(",
        "onError|doOnError|onErrorResume"
      ],
      "anti_patterns": [
        "buildClient\\(\\)(?!.*Async)",
        "secretClient\\.getSecret(?!.*subscribe)",
        "CompletableFuture",
        "async def|await ",
        "asyncio"
      ],
      "pattern_sources": [
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretasyncclient",
          "description": "Java SecretAsyncClient: reactive getSecret returning Mono, subscribe-based consumption"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclientbuilder",
          "description": "Java SecretClientBuilder.buildAsyncClient() for async client creation"
        },
        {
          "url": "https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html",
          "description": "Project Reactor Mono/Flux: subscribe() consumption pattern for reactive types, onErrorResume and doOnError for reactive error handling as required by prompt"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclient",
          "description": "Anti-patterns: sync SecretClient with buildClient() and blocking getSecret calls"
        },
        {
          "url": "https://docs.python.org/3/library/asyncio.html",
          "description": "Anti-patterns: Python async def, await, asyncio patterns"
        }
      ],
      "notes": "Java async client is syntactically similar to sync client (same builder, similar methods) but uses reactive patterns (Mono/Flux/subscribe). Tests whether sync client patterns bleed in (buildClient instead of buildAsyncClient, blocking calls). Also catches Python async (async def, await, asyncio) contamination."
    },
    {
      "id": "azure-security-keyvault-secrets-java-04",
      "type": "grounded",
      "prompt": "Given the following Java code that manages secrets with expiration and tags, add the missing functionality: implement soft-delete handling (beginDeleteSecret with polling), list deleted secrets, and recover a specific deleted secret. Handle the SyncPoller correctly.\n\n```java\nimport com.azure.security.keyvault.secrets.SecretClient;\nimport com.azure.security.keyvault.secrets.SecretClientBuilder;\nimport com.azure.security.keyvault.secrets.models.KeyVaultSecret;\nimport com.azure.security.keyvault.secrets.models.SecretProperties;\nimport com.azure.identity.DefaultAzureCredentialBuilder;\nimport java.time.OffsetDateTime;\nimport java.util.Map;\n\npublic class SecretManager {\n    private final SecretClient client;\n\n    public SecretManager(String vaultUrl) {\n        this.client = new SecretClientBuilder()\n            .vaultUrl(vaultUrl)\n            .credential(new DefaultAzureCredentialBuilder().build())\n            .buildClient();\n    }\n\n    public KeyVaultSecret createTaggedSecret(String name, String value, Map<String, String> tags) {\n        return client.setSecret(\n            new KeyVaultSecret(name, value)\n                .setProperties(new SecretProperties()\n                    .setExpiresOn(OffsetDateTime.now().plusYears(1))\n                    .setTags(tags)\n                )\n        );\n    }\n}\n```",
      "target_language": "java",
      "expected_patterns": [
        "beginDeleteSecret\\(",
        "SyncPoller",
        "DeletedSecret",
        "waitForCompletion\\(\\)",
        "listDeletedSecrets\\(\\)",
        "beginRecoverDeletedSecret\\("
      ],
      "anti_patterns": [
        "delete_secret\\(",
        "begin_delete_secret\\(",
        "list_deleted_secrets\\(",
        "recover_deleted_secret\\(",
        "secretClient\\.delete\\("
      ],
      "pattern_sources": [
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclient",
          "description": "Java SecretClient: beginDeleteSecret, listDeletedSecrets, beginRecoverDeletedSecret methods"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.core.util.polling.syncpoller",
          "description": "Java SyncPoller: waitForCompletion() for long-running delete/recover operations"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.models.deletedsecret",
          "description": "Java DeletedSecret model for soft-delete operations"
        },
        {
          "url": "https://learn.microsoft.com/en-us/python/api/azure-keyvault-secrets/azure.keyvault.secrets.secretclient",
          "description": "Anti-patterns: Python snake_case methods (delete_secret, begin_delete_secret, list_deleted_secrets)"
        }
      ],
      "notes": "Grounded Java extension task. Tests correct Java SDK method names for deletion lifecycle (beginDeleteSecret, SyncPoller, waitForCompletion, beginRecoverDeletedSecret). Anti-patterns detect Python snake_case method names bleeding in."
    },
    {
      "id": "azure-security-keyvault-secrets-java-05",
      "type": "adjacent_domain",
      "prompt": "Write a Java application that uses Azure Key Vault Keys SDK (not Secrets SDK) to create an RSA key, sign a message digest with it, and verify the signature. Use the KeyClient and CryptographyClient from the azure-security-keyvault-keys package.",
      "target_language": "java",
      "expected_patterns": [
        "KeyClient|KeyClientBuilder",
        "CryptographyClient|CryptographyClientBuilder",
        "createRsaKey|CreateRsaKeyOptions",
        "sign\\(|SignResult",
        "verify\\(|VerifyResult",
        "azure-security-keyvault-keys|keyvault\\.keys"
      ],
      "anti_patterns": [
        "SecretClient|SecretClientBuilder",
        "setSecret\\(",
        "getSecret\\(",
        "azure-security-keyvault-secrets|keyvault\\.secrets",
        "KeyVaultSecret"
      ],
      "pattern_sources": [
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.keys.keyclient",
          "description": "Java KeyClient: createRsaKey with CreateRsaKeyOptions"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.keys.cryptography.cryptographyclient",
          "description": "Java CryptographyClient: sign/verify methods returning SignResult/VerifyResult"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.keys.keyclientbuilder",
          "description": "Java KeyClientBuilder for key vault keys client creation"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclient",
          "description": "Anti-patterns: Java SecretClient, setSecret, getSecret from the secrets SDK"
        },
        {
          "url": "https://learn.microsoft.com/en-us/java/api/com.azure.security.keyvault.secrets.secretclientbuilder",
          "description": "Anti-patterns: Java SecretClientBuilder from the secrets SDK"
        }
      ],
      "notes": "Adjacent domain: Key Vault Keys SDK vs Key Vault Secrets SDK. Both are in the same Azure Key Vault family with similar builder patterns. Tests whether SecretClient/setSecret/getSecret patterns from the skill bleed into a Keys SDK task."
    }
  ]
}
