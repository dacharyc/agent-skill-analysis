{
  "skill_name": "upgrade-stripe-comprehensive",
  "scored_at": "2026-02-17T02:58:57.894343+00:00",
  "model_judge": "claude-opus-4-6",
  "model_generation": "claude-sonnet-4-5-20250929",
  "contamination_score": 0.93,
  "risk_level": "experimental",
  "test_category": "partial_knowledge",
  "tasks": [
    {
      "task_id": "upgrade-stripe-comprehensive-01",
      "task_type": "direct_target",
      "target_language": "python",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python with proper use of the stripe Python SDK. It correctly pins the API version, creates customers with email/metadata, creates subscriptions with price IDs, and handles Stripe exceptions comprehensively. The code is truncated (the `create_customer_with_subscription` method is cut off), costing it on completeness, but the core requested functionality is fully implemented. One minor note: in newer versions of the stripe library (v6+), exceptions are under `stripe.StripeError` rather than `stripe.error.StripeError`, but the pattern used here is correct for the widely-used v5.x and earlier SDKs.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": true
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": false
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "stripe\\.api_version"
              ],
              "expected_misses": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 1,
              "expected_total": 5,
              "expected_hit_rate": 0.2,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "stripe.error imports (InvalidRequestError, CardError, etc.) are from the older module-level API, not the newer StripeClient-based SDK which uses stripe.StripeError hierarchy differently",
                "StripeClient's v1.customers.create/v1.subscriptions.create use keyword arguments (e.g., params={}) which may not match the actual newer SDK calling convention exactly \u2014 the params/options dict pattern resembles the Node.js/TypeScript SDK pattern",
                "Accessing e.message, e.param, e.decline_code, e.request_id, e.user_message on exception objects follows patterns that may not all be accurate for the newer StripeClient exceptions",
                "self.client.v1.customers.delete(customer.id) \u2014 the newer SDK typically takes params dict rather than positional ID argument"
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, type hints, docstrings, and cleanup logic. However, it mixes the older stripe.error exception hierarchy with the newer StripeClient interface, which is a contamination signal \u2014 the StripeClient SDK uses different exception classes. The params/options keyword pattern for API calls resembles the Node.js SDK convention rather than the Python SDK's typical calling convention. The code is truncated at the end (create_customer method cut off), but the main task functionality is largely implemented in create_customer_with_subscription.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create"
              ],
              "expected_misses": [
                "stripe\\.api_version",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 3,
              "expected_total": 5,
              "expected_hit_rate": 0.6,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Using `self.client.v1.customers.create(params={...})` with a `params` keyword \u2014 the newer StripeClient API in Python uses positional or direct keyword arguments (e.g., `self.client.customers.create(email=email, metadata=metadata)`), not a `params` dict. The `v1` namespace and `params={}` pattern resembles the Java/Ruby SDK style or an assumed but not-yet-standard Python pattern.",
                "Importing exceptions like `InvalidRequestError`, `CardError`, `AuthenticationError`, `RateLimitError`, `APIConnectionError` directly from `stripe` \u2014 while these exist in the `stripe` package, the newer `StripeClient`-based SDK uses `stripe.error.*` namespace; mixing the old module-level exceptions with the new client-based API suggests uncertainty about the actual Python SDK interface.",
                "The `stripe_version` parameter name in `StripeClient()` constructor \u2014 the actual Python `StripeClient` constructor may use `stripe_version` or `api_version` depending on the SDK version, but combined with the `v1` namespace access pattern, this looks like it's borrowing from the newer multi-language SDK design that may not yet be fully reflected in the Python SDK's public API."
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, logging, type hints, and comprehensive error handling. However, the API usage shows contamination: the `self.client.v1.customers.create(params={...})` pattern with a `params` dictionary and `v1` namespace is not the standard idiomatic Python Stripe SDK pattern (which uses `stripe.Customer.create(email=...)` or the newer `client.customers.create(email=...)`). The module covers all requested functionality \u2014 client initialization, customer creation, and subscription creation \u2014 but the API calling convention is questionable for the actual Python SDK.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create"
              ],
              "expected_misses": [
                "stripe\\.api_version",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 3,
              "expected_total": 5,
              "expected_hit_rate": 0.6,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python with no foreign language patterns. It uses the older `stripe.error.*` exception hierarchy (pre-v6 style with `stripe.error` instead of `stripe.StripeError`, etc.) and sets the global `stripe.api_key` rather than using the newer `stripe.StripeClient` constructor, but this is still a valid and widely-used pattern in the Python SDK. The code is truncated at the end (the final `except Exception` block is cut off), which slightly impacts functional correctness and code quality, but the vast majority of the task\u2014initializing with a pinned API version, creating a customer with email/metadata, creating a subscription with a price ID, and handling Stripe exceptions\u2014is implemented. Overall, this is well-structured, well-documented code with only minor issues.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": true
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": false
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "stripe\\.api_version"
              ],
              "expected_misses": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 1,
              "expected_total": 5,
              "expected_hit_rate": 0.2,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Import path 'stripe.error' is incorrect for newer stripe-python SDK versions that use StripeClient; modern versions use 'stripe' namespace directly (e.g., stripe.StripeError, stripe.InvalidRequestError)",
                "The 'client.v1.customers.create(params=params, options={...})' calling convention with explicit 'params' and 'options' keyword arguments resembles the Java/Node.js SDK patterns rather than the Python SDK's typical keyword-argument style",
                "Re-raising exceptions by constructing new instances of Stripe error classes with positional message strings may not match the actual constructor signatures of these exception classes in the Python SDK",
                "The 'options' parameter with 'idempotency_key' as a dict is more characteristic of the Node.js SDK pattern; Python SDK typically uses idempotency_key as a direct parameter or via stripe.RequestOptions"
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, type hints, and documentation. However, it shows API contamination from other Stripe SDKs: the `client.v1.customers.create(params=..., options=...)` calling pattern and the import from `stripe.error` suggest mixing Node.js/Java SDK patterns with the Python SDK. The error re-raising with custom constructors likely won't match the actual Python exception class signatures. The code is also truncated \u2014 the `create_customer_with_subscription` function is cut off mid-implementation.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create"
              ],
              "expected_misses": [
                "stripe\\.api_version",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 3,
              "expected_total": 5,
              "expected_hit_rate": 0.6,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The `self.client.v1.customers.create(params={...})` pattern with a `params` keyword wrapping a dict is slightly unusual \u2014 the newer StripeClient API in Python typically accepts keyword arguments directly (e.g., `self.client.customers.create(email=email, metadata=metadata)`), though `params` dict style is documented for the StripeClient approach. The `v1` namespace accessor (`self.client.v1.customers`) may reflect newer SDK patterns but could also be a confusion with other SDK conventions."
              ],
              "brief_assessment": "The code is entirely valid Python with proper type hints, logging, and structured error handling. It uses the newer StripeClient constructor correctly for version pinning and handles cleanup on partial failures, which is a nice touch. The API call pattern using `self.client.v1.customers.create(params={...})` is plausible for the newer stripe-python StripeClient but is slightly non-standard compared to the more common keyword-argument style. The code is truncated \u2014 the `create_subscription` method is cut off, so it doesn't fully complete the task, though the combined method above covers the functionality.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_misses": [
                "stripe\\.api_version"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Python with correct syntax and idiomatic patterns. It uses the older `stripe.error.*` exception hierarchy (which was the standard before the newer `stripe` v2+ SDK introduced `stripe.StripeError` directly), but this is still valid and widely used. The code properly initializes the API version, creates customers with email/metadata, and creates subscriptions with a price ID, all with comprehensive error handling. The code is truncated at the `create_customer_with_subscription` convenience method, but the core required functionality (customer creation and subscription creation) is fully implemented. The docstrings claim returning None on failure but actually re-raise exceptions, which is a minor inconsistency.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": true
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": false
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "stripe\\.api_version"
              ],
              "expected_misses": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 1,
              "expected_total": 5,
              "expected_hit_rate": 0.2,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 3,
              "contamination_signals": [
                "Import from 'stripe.error' module - newer stripe-python SDK uses 'stripe' directly for exceptions (e.g., stripe.InvalidRequestError) or the StripeClient approach uses different exception paths",
                "The StripeClient's service-based API (self.client.v1.customers.create) with 'params' and 'options' keyword arguments may not match the actual Python SDK's StripeClient interface precisely - the Python SDK StripeClient uses named parameters directly rather than a 'params' dict",
                "Re-raising exceptions by constructing new instances of Stripe error classes with modified messages uses constructor signatures that may not match the actual Python SDK error class constructors (e.g., CardError, InvalidRequestError, StripeError constructors have specific required arguments)",
                "The 'options={\"idempotency_key\": ...}' pattern resembles other language SDKs (e.g., Node.js/Ruby) more than the Python SDK's typical approach"
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, type hints, and documentation. However, it shows contamination in the API usage: the StripeClient service-based pattern (client.v1.customers.create with params/options dicts) doesn't precisely match the actual Python stripe-python SDK interface, where StripeClient methods accept keyword arguments directly rather than a params dictionary. The error re-raising pattern with modified constructors is also problematic as Stripe exception constructors have specific signatures. The code is truncated, cutting off mid-way through the create_subscription error handling block.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": false
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create"
              ],
              "expected_misses": [
                "stripe\\.api_version",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_hit_count": 3,
              "expected_total": 5,
              "expected_hit_rate": 0.6,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Using `self.client.v1.customers.create(params={...})` \u2014 the `v1` namespace and `params` keyword are not part of the standard stripe-python StripeClient API. The idiomatic Python StripeClient usage is `self.client.customers.create(email=..., metadata=...)` with keyword arguments directly, not a `params` dict.",
                "The `params={...}` dictionary pattern resembles the Node.js/TypeScript Stripe SDK or possibly the newer StripeClient raw request pattern, not the standard Pythonic keyword-argument approach.",
                "Exception attributes like `e.message` and `e.param` are correct for stripe-python, but `e.user_message` on CardError is not standard \u2014 the Python SDK uses `e.user_message` in some contexts but this is less common than accessing `e.error.message`."
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, logging, type hints, and docstrings. However, the API usage shows contamination: the `self.client.v1.customers.create(params={...})` pattern with a `v1` namespace and `params` dictionary is not the standard idiomatic stripe-python approach, which uses keyword arguments directly (e.g., `stripe.Customer.create(email=..., metadata=...)` or `client.customers.create(email=..., metadata=...)`). The code is also slightly truncated at the end (the last `create_subscription` method's except block is cut off), but functionally it covers all the requested features.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "v1\\.customers\\.create|client\\.customers\\.create",
                  "matched": true
                },
                {
                  "pattern": "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "v1\\.customers\\.create|client\\.customers\\.create",
                "v1\\.subscriptions\\.create|client\\.subscriptions\\.create",
                "stripe\\.StripeError|stripe\\.CardError|stripe\\.InvalidRequestError"
              ],
              "expected_misses": [
                "stripe\\.api_version"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Customer",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-02",
      "task_type": "cross_language",
      "target_language": "go",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Go with no foreign language patterns. It correctly uses the stripe-go v76 library with idiomatic patterns including package-level functions (customer.Get, customer.Update, paymentmethod.Attach), stripe.String() helpers, iterator patterns for listing, and proper error wrapping. The API version is set via stripe.APIVersion which is the correct approach, though wrapping a global-state library in a struct is somewhat misleading since the stripe-go library uses global configuration. The error code check for ErrorCodeResourceAlreadyExists may not match the actual Stripe error code for already-attached payment methods (which is typically 'resource_already_exists' but the constant name may differ). The code is truncated at the very end of main() but the core task functions are complete. Minor issue: the StripeClient wrapper gives a false impression of instance-based configuration when stripe-go uses globals.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 4,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Missing 'time' import - code uses time.Sleep and time.Duration without importing the time package",
                "stripe-go v84 does not exist as of any known release; latest major versions are around v76-v81, suggesting hallucinated version number",
                "stripe.ErrorTypeConnection and stripe.ErrorTypeRateLimit may not exist as constants in the actual stripe-go SDK - these look like they could be borrowed from other language SDKs or hallucinated"
              ],
              "brief_assessment": "The code is well-structured Go that correctly demonstrates the pattern of initializing a Stripe client, retrieving a customer, and updating their default payment method using idiomatic stripe-go patterns (customer.Get, customer.Update, stripe.CustomerParams with InvoiceSettings). The main issues are: (1) a missing 'time' import causing a compilation error, (2) a fabricated SDK version (v84), and (3) some error type constants (ErrorTypeConnection, ErrorTypeRateLimit) that may not exist in the actual stripe-go library. The retry logic with the unwrapped stripe.Error won't work correctly since the error returned from UpdateCustomerDefaultPaymentMethod is already wrapped in fmt.Errorf. Despite these issues, the core Stripe API patterns are correct and idiomatic for Go.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 4,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Package declaration 'package stripe' conflicts with the imported stripe package - this is a Go-specific mistake but suggests unfamiliarity with Go package naming conventions",
                "Using 'customer' sub-package directly (customer.Get, customer.Update) which is the older stripe-go pattern; modern stripe-go v7x+ uses client-based approach with stripe.NewBackendsHTTPClient or similar",
                "Version v84 does not exist for stripe-go; the actual latest major versions are around v76-v81, suggesting hallucination",
                "Setting stripe.Key globally rather than using a per-client approach - while this works, it's the older pattern and the task specifically asked for 'initializes a Stripe client'",
                "The task asked to 'initialize a Stripe client' but the code uses the global/package-level API pattern instead of creating a client instance (e.g., client.API)"
              ],
              "brief_assessment": "The code is valid Go and uses recognizable stripe-go patterns, but it uses the older global-key approach with sub-package function calls rather than initializing a proper Stripe client instance as requested. The package name 'stripe' conflicts with the imported stripe package, which would cause a compilation error. The version v84 is fabricated, and the task's requirement to 'initialize a Stripe client' is not met since no client object is created. The error handling and overall structure are reasonable.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Go with correct syntax and idiomatic patterns. It properly uses the stripe-go v76 library with the correct package-level API (customer.Get, customer.Update, paymentmethod.Attach, paymentmethod.List) and idiomatic helpers like stripe.String(). The functional implementation covers all three requested tasks (init client, retrieve customer, update default payment method) plus extras like listing payment methods and attaching before updating. Minor issues: the error code check for ErrorCodeResourceAlreadyExists may not be the exact code Stripe returns for already-attached payment methods (it's typically 'resource_already_exists' but the actual behavior differs), setting stripe.APIVersion directly is acceptable but slightly non-standard, and the advanced example is truncated mid-code. The wrapper struct around global state is a reasonable pattern but slightly misleading since stripe-go uses global config.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The version number v84 is unrealistically high - current stripe-go versions are around v76-v79, suggesting the model hallucinated the version rather than using a real one",
                "The error type assertion in main() won't work as written because the error is wrapped with fmt.Errorf/%w, so the *stripe.Error type assertion would fail without errors.As()"
              ],
              "brief_assessment": "The code is entirely valid Go with idiomatic stripe-go patterns. It correctly uses the package-level customer functions (customer.Get, customer.Update), stripe.String() helper, CustomerInvoiceSettingsParams for setting the default payment method, and demonstrates both the global key approach and the custom client approach. The main issues are: (1) the v84 import path is a fabricated version number, (2) the error handling in main() uses a direct type assertion on a wrapped error which would fail \u2014 it should use errors.As() instead. The code is well-structured with good comments and demonstrates proper understanding of the stripe-go SDK patterns.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 4,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "Package declaration is 'package stripe' which conflicts with the stripe-go import alias 'stripe' - this would cause a compilation error and suggests confusion about Go package naming conventions",
                "Using 'github.com/stripe/stripe-go/v84' - v84 does not exist; the stripe-go library uses semantic versioning (e.g., v76, v78, v79, v80, v81) but v84 appears fabricated",
                "The claim that 'You cannot manually set a different API version in Go' is incorrect; stripe.APIVersion exists and stripe.APIBackend allows version configuration",
                "Setting stripe.Key as a global variable rather than using client.API (per-client backends) is a dated pattern; the task asked for 'initializes a Stripe client' suggesting the per-client approach"
              ],
              "brief_assessment": "The code demonstrates the correct general pattern for using stripe-go: setting the API key, calling customer.Get and customer.Update, and using CustomerInvoiceSettingsParams for the default payment method. However, the package is named 'stripe' which directly conflicts with the imported stripe-go package, causing a compile error. The version v84 is fabricated, and the code uses the global stripe.Key approach rather than initializing a proper client instance (client.API), which is what the task specifically requested. The functional logic is mostly correct but the package naming issue prevents compilation.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Go with no foreign language patterns. It correctly uses the stripe-go/v76 library with idiomatic patterns including stripe.String() helpers, iterator-based list traversal, and proper error wrapping. The code fully accomplishes the task \u2014 initializing the client, retrieving a customer, and updating the default payment method \u2014 with useful extras like payment method attachment and listing. Minor issues: the custom StripeClient wrapper around global state is somewhat redundant (stripe-go uses global config by default), setting stripe.APIVersion directly is functional but slightly unusual (most users rely on the library default), and the error code check for ErrorCodeResourceAlreadyExists may not match the actual Stripe error code for already-attached payment methods. The second code block is truncated but the core task is fully complete in the first block.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The version 'v84' does not exist for stripe-go; real versions are in the v70s-v80 range at most, suggesting a hallucinated version number",
                "The error type assertion on wrapped errors (fmt.Errorf with %w) won't work directly with *stripe.Error without using errors.As instead of direct type assertion"
              ],
              "brief_assessment": "The code is entirely valid Go with idiomatic stripe-go patterns. It correctly uses the package-level `customer.Get`/`customer.Update` functions, `stripe.String()` helper, and `CustomerInvoiceSettingsParams` for setting the default payment method. The main issues are: (1) the version `v84` is likely hallucinated, (2) the error type assertion in `main()` will fail on wrapped errors\u2014`errors.As` should be used instead of direct type assertion since the error is wrapped with `fmt.Errorf(\"%w\")`. The alternative client-based approach is also well-structured and idiomatic. Overall, this is solid code with minor correctness issues.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Go with no foreign language patterns. The stripe-go API usage is mostly idiomatic \u2014 using the package-level `customer.Get`, `customer.Update`, `stripe.String()`, `stripe.CustomerParams`, and `stripe.CustomerInvoiceSettingsParams` are all correct patterns for the stripe-go library. The version number `v84` is unusually high (current latest is around v79-v81), which is a minor inaccuracy but not a contamination signal. The package name `stripe` conflicts with the imported `stripe` package, which would cause a compilation error \u2014 this is a notable quality issue. The functional approach is sound: it retrieves the customer, validates inputs, and updates the default payment method with proper error handling. The code does not demonstrate explicit API version handling beyond relying on the SDK version, which is the correct Go approach but could have been mentioned more explicitly.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "github\\.com/stripe/stripe-go",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Key\\s*=",
                  "matched": true
                },
                {
                  "pattern": "customer\\.Get\\(",
                  "matched": true
                },
                {
                  "pattern": "func\\s+\\w+\\(",
                  "matched": true
                }
              ],
              "expected_hits": [
                "github\\.com/stripe/stripe-go",
                "stripe\\.Key\\s*=",
                "customer\\.Get\\(",
                "func\\s+\\w+\\("
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-03",
      "task_type": "similar_syntax",
      "target_language": "javascript",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely correct JavaScript/Node.js with idiomatic Express and Stripe SDK usage. It properly initializes Stripe with explicit API versioning via the options object, correctly uses express.raw() to preserve the raw body for webhook signature verification with stripeClient.webhooks.constructEvent(), and implements a clean event dispatching pattern via a handler map. The architecture is well-structured as a factory function, includes proper error handling, and the usage example correctly places express.raw() before express.json(). The only minor issue is the truncated PORT line at the end of app.js, but all three requested features are fully implemented.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "stripe\\.webhooks\\.constructEvent"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 4,
              "contamination_signals": [
                "The API version '2026-01-28.clover' appears fabricated/hallucinated rather than being a real Stripe API version, though this is a hallucination issue rather than cross-language contamination",
                "The tolerance parameter passed as 4th argument to constructEvent may not match the actual Stripe Node.js SDK signature - the SDK typically accepts tolerance via an options object or only accepts 3 arguments (payload, sig, secret)"
              ],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with proper Express patterns. It correctly addresses all three requirements: Stripe initialization with explicit API versioning, webhook signature verification using raw body, and event dispatching based on event type. The main concern is that `constructEvent` in the Node.js Stripe SDK takes 3 positional arguments (payload, header, secret) with tolerance optionally set differently - passing it as a 4th positional argument may not work as intended. The in-memory deduplication via Set with a simple size-based clear is a pragmatic but crude approach. The usage example is truncated mid-output. Overall, this is well-structured, well-documented code with minor API accuracy issues.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [],
              "expected_hit_count": 5,
              "expected_total": 5,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js using correct Express and Stripe SDK APIs idiomatically. It properly initializes Stripe with explicit API versioning, uses express.raw() for raw body parsing, verifies webhook signatures via stripe.webhooks.constructEvent(), and dispatches events through a Map-based handler registry. Minor issues: the API version string '2026-01-28.clover' is fictitious, the code sends res.json() before async processing which means errors can't influence the response, the idempotency Set is simplistic, and the last handler file is truncated mid-line. These are quality/completeness concerns rather than contamination.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "require\\(['\"]stripe['\"]\\)"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "typescript: true option passed to Stripe constructor is a TypeScript-related config, slightly odd in a pure JS context"
              ],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with proper Express and Stripe API usage. It correctly initializes Stripe with explicit API versioning, verifies webhook signatures using constructEvent with the raw body, and dispatches events via a handler map. Minor issues include the `typescript: true` option being unnecessary in a JS context, the slightly unusual pattern of using both `express.raw()` with a `verify` callback and then referencing `req.rawBody` (when the body is already available as `req.body` buffer after `express.raw()`), and the event handler examples being truncated at the end. Overall it's well-structured and functional.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "req\\.body",
                  "matched": false
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body"
              ],
              "expected_hit_count": 3,
              "expected_total": 5,
              "expected_hit_rate": 0.6,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely correct JavaScript/Node.js with idiomatic use of the Stripe Node SDK (constructEvent, explicit apiVersion, raw body handling). It properly initializes Stripe with versioning, verifies webhook signatures, and dispatches events to handler functions. The code is slightly cut off at the end of the usage example, but the core middleware implementation is complete. One design concern is responding with 200 before async processing completes, which means failures won't be reflected to Stripe for retry, though this is a deliberate architectural choice. The in-memory idempotency Set is a nice touch but not production-suitable. The fictional API version '2026-01-28.clover' is odd but not a contamination issue.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [],
              "expected_hit_count": 5,
              "expected_total": 5,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with idiomatic use of the Stripe Node.js SDK, Express middleware patterns, and ES module syntax. The core task \u2014 initializing Stripe with explicit API versioning, verifying webhook signatures via `stripe.webhooks.constructEvent` with the raw body, and dispatching events to registered handlers \u2014 is fully implemented. Minor concerns: the dispatch middleware sends the response and then continues async processing (meaning errors can't affect the response), which is a deliberate design choice but worth noting; the API version string '2026-01-28.clover' is fictitious; and the final `app.js` file is truncated, cutting off the `express.raw()` configuration, though the middleware itself is complete and functional.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "require\\(['\"]stripe['\"]\\)"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with correct Express middleware patterns and proper Stripe SDK usage. The Stripe initialization with explicit `apiVersion`, `webhooks.constructEvent()` for signature verification, and event-type-based dispatching are all idiomatic. Minor concerns: the `captureRawBody` function concatenates as a string rather than using `express.raw()` or `express.json({ verify: ... })` which is the more standard approach; returning 500 instead of 200 on handler errors could cause Stripe retries contrary to the comment's intent. The usage example is truncated mid-handler, but the core middleware implementation is complete and functional.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "stripe\\.webhooks\\.constructEvent"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with proper Express and Stripe SDK usage. The Stripe initialization with explicit apiVersion and webhook signature verification via stripe.webhooks.constructEvent() are idiomatic. One minor concern: the tolerance parameter passed as a 4th argument to constructEvent is not part of the standard API signature (it's typically passed as part of an options object or not at all in recent versions), and the fictional API version '2026-01-28.clover' is odd but not a contamination issue. The pattern of sending the response before async processing is a reasonable design choice but means handler failures can't influence the HTTP response. The usage example is truncated mid-handler, but the core middleware is complete.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": true
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "require\\(['\"]stripe['\"]\\)",
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [],
              "expected_hit_count": 5,
              "expected_total": 5,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The API version string '2026-01-28.clover' appears fabricated/non-existent, though the pattern of specifying apiVersion is correct"
              ],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js using the correct Stripe Node SDK APIs (stripe.webhooks.constructEvent, proper initialization pattern). It successfully implements all three requested features: Stripe initialization with explicit API versioning, webhook signature verification using raw body, and event dispatching via a handler registry. The code is slightly truncated at the end (the webhook route setup is cut off), and there's a subtle issue where dispatchStripeEvent sends a response then continues processing \u2014 calling next() after res.json() would be problematic, but since next() isn't called after the response, the async-after-response pattern is intentional. The idempotencyKey helper uses the wrong property name (should be idempotency_key for the Stripe Node SDK options object), which is a minor API deviation.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "apiVersion:\\s*['\"]",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": true
                },
                {
                  "pattern": "req\\.body",
                  "matched": true
                },
                {
                  "pattern": "module\\.exports|export",
                  "matched": true
                }
              ],
              "expected_hits": [
                "apiVersion:\\s*['\"]",
                "stripe\\.webhooks\\.constructEvent",
                "req\\.body",
                "module\\.exports|export"
              ],
              "expected_misses": [
                "require\\(['\"]stripe['\"]\\)"
              ],
              "expected_hit_count": 4,
              "expected_total": 5,
              "expected_hit_rate": 0.8,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "stripe_version=",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Webhook",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-04",
      "task_type": "grounded",
      "target_language": "python",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python using the correct stripe Python SDK patterns with no cross-language contamination. The API version string and Stripe.js script tag path are updated correctly from acacia/basil to clover. The functional score is slightly reduced because the task asked to 'replace any deprecated patterns' yet the response simply states none were found without demonstrating any investigation or potential updates (e.g., newer parameter names, return_url vs success_url changes, etc.) \u2014 this could be correct if no deprecations exist, but given these are fictional API versions it's hard to fully verify. The code quality is good with helpful documentation and recommendations, though it lacks error handling in the code itself.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python with no cross-language contamination. It correctly updates the API version string from '2024-12-18.acacia' to '2026-01-28.clover' and updates the Stripe.js script tag from 'basil' to 'clover'. The migration to StripeClient with `client.v1.checkout.sessions.create(params={...})` follows the modern stripe-python SDK pattern introduced in recent versions, though the exact `params=` keyword dict wrapping and `v1` namespace are plausible but difficult to fully verify against a future API version. The inclusion of both modern and legacy approaches, plus comprehensive documentation, makes this high-quality output. Minor deduction on functional correctness since the task says 'replace deprecated patterns' but there's no concrete evidence the original patterns were actually deprecated \u2014 the code speculatively upgrades to StripeClient which is reasonable but unverifiable for a fictional future version.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Python with no cross-language contamination. The upgrade to StripeClient with the v1 namespace and params dict pattern is a plausible modern idiom for the stripe-python SDK, though the exact `client.v1.checkout.sessions.create(params={...})` signature cannot be fully verified against a real 2026 API version (since it doesn't exist yet). The code accomplishes the task well \u2014 updating the API version string, updating the Stripe.js script tag from basil to clover, and modernizing the client pattern. Providing both the modern StripeClient approach and the legacy alternative is a nice touch. The only minor concern is that the params dict-based calling convention may not perfectly match the actual stripe-python SDK's StripeClient interface, but it's a reasonable projection of the documented direction.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python using the idiomatic stripe Python SDK. The API version string and Stripe.js script tag are correctly updated from acacia/basil to clover. Since the task involves a fictional API version upgrade (2026-01-28.clover doesn't exist yet), it's impossible to verify whether deprecated patterns were truly addressed or if the checkout session creation code would need changes \u2014 the code essentially just swaps version strings and assumes no breaking changes. The notes and recommendations are helpful but the code doesn't demonstrate any actual deprecated-pattern replacements, which was part of the task request.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Python with correct syntax and no cross-language contamination. It uses the modern StripeClient pattern with `client.v1.checkout.sessions.create(params={...})` which aligns with the newer stripe-python SDK's service-based approach. Since the target API version '2026-01-28.clover' is fictional, it's impossible to fully verify the exact API surface, but the patterns used (StripeClient initialization, v1 namespace, params dict) are consistent with the direction the stripe-python SDK has been moving. The code is thorough, well-documented, includes error handling examples, and correctly updates the Stripe.js script tag from basil to clover. The only minor concern is whether the `params=` keyword argument style is precisely correct versus positional/keyword arguments, but this is a reasonable extrapolation of the SDK's evolution.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Python with no cross-language contamination. It correctly updates the API version string and the Stripe.js script tag from 'basil'/'acacia' to 'clover'. The migration to StripeClient with the v1 namespace is a plausible modernization pattern that Stripe has been moving toward (introduced in stripe-python v7+). The use of `params={}` as a keyword dict is slightly uncertain \u2014 the actual StripeClient API in recent versions accepts named keyword arguments directly rather than wrapping them in a `params` dict, which is more reminiscent of HTTP client libraries. However, since these are fictional future API versions, this is a reasonable interpretation. The code is well-structured and the explanation of changes is clear.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": false
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]"
              ],
              "expected_hit_count": 2,
              "expected_total": 3,
              "expected_hit_rate": 0.6666666666666666,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": false
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "basil"
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.25,
              "contamination_detected": true
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The Python code is entirely correct in language and uses the idiomatic stripe Python SDK API. The version string and Stripe.js script tag are properly updated from acacia/basil to clover. The code loses a point on functional correctness because the task asked to 'replace any deprecated patterns' but the response simply states none were found without demonstrating any investigation or awareness of potential API changes between these versions (e.g., changes to checkout session parameters). The included JavaScript snippet for Stripe initialization is a reasonable addition but is minor supplementary content, not contamination.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in Python (and appropriate HTML/JS for the frontend portion) with no cross-language contamination. It correctly updates the API version string from acacia to clover, updates the Stripe.js script tag from basil to clover, and migrates to the modern StripeClient pattern with client.v1.checkout.sessions.create(). Since 2026-01-28.clover is a hypothetical future API version, the exact correctness of the StripeClient interface (params dict wrapping, v1 namespace) cannot be fully verified, but it closely matches the patterns introduced in recent stripe-python versions (v7+). The code is thorough, well-documented, and includes helpful extras like error handling, idempotency keys, and environment variable usage.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": true
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [],
              "expected_hit_count": 3,
              "expected_total": 3,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The `params={}` keyword argument pattern in `client.v1.checkout.sessions.create(params={...})` resembles patterns from other language SDKs (e.g., Node.js/TypeScript) rather than the Python SDK's typical keyword argument style, though the StripeClient pattern itself is a real newer Python SDK pattern"
              ],
              "brief_assessment": "The code correctly upgrades the API version string and Stripe.js script tag, and appropriately migrates to the StripeClient pattern which is the modern recommended approach in the Python SDK. The use of `params={}` as a dictionary argument rather than passing keyword arguments directly is slightly atypical for the Python SDK's idiomatic style, where keyword arguments are more common. The code is well-structured, clearly documented with explanation of changes, and would largely accomplish the upgrade task, though the exact API surface (`client.v1.checkout.sessions.create`) and parameter passing style cannot be fully verified against a future/hypothetical API version.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]",
                  "matched": false
                },
                {
                  "pattern": "js\\.stripe\\.com/clover/stripe\\.js",
                  "matched": true
                }
              ],
              "expected_hits": [
                "2026-01-28\\.clover",
                "js\\.stripe\\.com/clover/stripe\\.js"
              ],
              "expected_misses": [
                "stripe\\.api_version\\s*=\\s*['\"]2026-01-28\\.clover['\"]"
              ],
              "expected_hit_count": 2,
              "expected_total": 3,
              "expected_hit_rate": 0.6666666666666666,
              "anti_results": [
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "basil",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe\\.api_version",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia",
                "basil"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.5,
              "contamination_detected": true
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-05",
      "task_type": "adjacent_domain",
      "target_language": "ruby",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely idiomatic Ruby/Rails with correct usage of the Stripe Ruby gem API (Stripe::Webhook.construct_event, event.data.object, etc.). It handles all three required webhook events, verifies signatures, and updates database records. However, the code is clearly truncated \u2014 the handle_status_change method is cut off mid-implementation, and likely revoke_subscription_access and the associated controller/migration are missing. The overall structure, error handling, and use of Rails patterns (deliver_later, find_or_initialize_by, assign_attributes) are well done.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely idiomatic Ruby/Rails with correct usage of the Stripe Ruby SDK (Stripe::Webhook.construct_event, event.data.object, proper keyword arguments). It handles all three required webhook event types with signature verification, idempotency via ProcessedWebhookEvent, and database updates. The code is truncated mid-method (find_or_create_customer cuts off at 'stripe_cust') and helper methods like sync_subscription_items and handle_status_change are referenced but not defined, which prevents a perfect functional correctness score. Overall the code demonstrates production-quality patterns including error handling, logging, and mailer integration.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with idiomatic Rails patterns. It correctly uses the Stripe Ruby SDK's `Stripe::Webhook.construct_event` for signature verification, handles all three requested subscription lifecycle events, and includes idempotency via a ProcessedWebhookEvent model. Minor issues: it inherits from an undefined `ApplicationService` with an undefined `with_error_handling` method, and the `rescue` clause sits outside the `with_error_handling` block which creates ambiguity. The controller file is truncated, but the core service class is complete. The ServiceResult pattern, while not strictly necessary, is clean Ruby. No cross-language contamination detected.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely idiomatic Ruby with proper use of the Stripe Ruby gem API (Stripe::Webhook.construct_event, event.data.object, etc.) and Rails conventions (service object pattern, keyword arguments, ActiveRecord, deliver_later, Rails.logger). It handles all three required webhook events with signature verification and local database updates. The only issue is that the controller implementation is truncated mid-line, leaving the webhook endpoint incomplete, though the core service class is fully realized and production-quality.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely idiomatic Ruby/Rails with correct usage of the Stripe Ruby SDK (Stripe::Webhook.construct_event, event.data.object, etc.) and Rails conventions (service objects, keyword arguments, deliver_later, credentials.dig). It handles all three required webhook events with signature verification and database updates. However, the code is truncated mid-function \u2014 the sync_subscription_items and handle_status_transition methods are incomplete, and there's no controller shown. Despite the truncation, the majority of the task is well-implemented with good error handling, idempotency via ProcessedWebhookEvent, and proper logging.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with idiomatic Rails patterns (service object, ActiveRecord, credentials, logging). The Stripe API usage (Webhook.construct_event, SignatureVerificationError, accessing event.data.object) is correct and idiomatic for the stripe-ruby gem. The code is truncated mid-method (extract_plan_id is cut off), and it depends on undefined infrastructure (ApplicationService, ServiceResult, ProcessedWebhookEvent, with_error_handling) which limits completeness, but the core logic for all three subscription events plus signature verification is well-implemented. No cross-language contamination detected.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "This is excellent, idiomatic Ruby code that fully accomplishes the task. It correctly uses the Stripe Ruby gem's API (Stripe::Webhook.construct_event, event.data.object, accessing subscription fields via dot notation), follows Ruby conventions (keyword arguments, bang methods, safe navigation operator, frozen constants), and implements all three required webhook events with proper signature verification. The code is well-structured with comprehensive error handling, custom exception hierarchy, status change tracking, user notification hooks, and access management \u2014 all organized cleanly as a service object pattern common in Rails applications.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely idiomatic Ruby/Rails with correct usage of the Stripe Ruby gem API (Stripe::Webhook.construct_event, event.data.object, accessing nested attributes via dot notation). It handles all three required webhook events, verifies the signature, implements idempotency via ProcessedWebhookEvent, and uses proper Rails patterns (transactions, deliver_later, find_by!, etc.). The code is truncated at the end of handle_subscription_deleted (cut off mid-line at `.de`), which means the deletion handler and likely a helper method (handle_status_transition, find_or_create_user) are incomplete, preventing a perfect functional correctness score.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 3,
              "code_quality": 3,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with idiomatic Rails patterns (service objects, ActiveRecord, frozen_string_literal). The Stripe API usage (Stripe::Webhook.construct_event, event.data.object, accessing subscription fields) is correct and idiomatic for the stripe-ruby gem. However, the code is clearly truncated \u2014 the sync_subscription_items method is cut off mid-implementation, and it depends on undefined classes (ApplicationService, ServiceResult, ProcessedWebhookEvent, Subscription) without providing them, making it incomplete. The custom ApplicationService/ServiceResult pattern adds unnecessary coupling to undefined abstractions, and the with_error_handling block is called but never defined.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Webhook\\.construct_event",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                },
                {
                  "pattern": "customer\\.subscription\\.",
                  "matched": true
                },
                {
                  "pattern": "def\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Webhook\\.construct_event",
                "class\\s+\\w+",
                "customer\\.subscription\\.",
                "def\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.webhooks\\.constructEvent",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 4,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-06",
      "task_type": "grounded",
      "target_language": "python",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code correctly migrates from the legacy global stripe module pattern to the new StripeClient pattern in Python. The API usage is largely idiomatic \u2014 `StripeClient`, `client.payment_intents.create()`, `client.refunds.create()`, and `stripe_version` parameter are all correct for the Python SDK. The use of `params=` as a keyword argument wrapping a dict is consistent with the new StripeClient Python SDK's documented calling convention. The code preserves all original business logic, adds proper type hints, improved the `amount_cents is not None` check over the original truthy check, and is well-documented with docstrings and usage examples. The wrapping in a class is a nice architectural improvement for testability and thread safety.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": false
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [
                "2026-01-28\\.clover"
              ],
              "expected_hit_count": 3,
              "expected_total": 4,
              "expected_hit_rate": 0.75,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.2,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python with no cross-language contamination. It correctly migrates to the StripeClient pattern using `self.client.v1.payment_intents.create(params=params, options=options)`, which aligns with the modern Python stripe SDK's StripeClient interface. Minor concerns: the API version '2026-01-28.clover' appears fabricated (the original used '2024-12-18.acacia'), exception classes like `stripe.CardError` and `stripe.InvalidRequestError` may have changed in newer SDK versions (now under `stripe.error`), and the `params`/`options` keyword argument passing style may not exactly match the SDK's actual signature (some versions use positional or direct kwargs). The business logic is fully preserved with the addition of idempotency keys and error handling as enhancements. The bug fix changing `if amount_cents:` to `if amount_cents is not None:` in refund_payment is a genuine improvement.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": true
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "stripe\\.PaymentIntent\\.create",
                "stripe\\.Refund\\.create"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.4,
              "contamination_detected": true
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [
                "The `params={}` keyword argument pattern in `client.v1.payment_intents.create(params={...})` is reminiscent of the Node.js/TypeScript Stripe SDK pattern rather than the Python SDK, where the Python StripeClient typically accepts keyword arguments directly (e.g., `client.payment_intents.create(amount=..., currency=...)`) or uses a dict passed as a positional argument, not necessarily `params=` as a keyword"
              ],
              "brief_assessment": "The code correctly migrates to the StripeClient pattern in Python with proper type hints, docstrings, and environment variable usage. The `params={...}` keyword argument style is a plausible but slightly unusual pattern that may reflect Node.js SDK contamination, where params are typically passed as an object argument. The business logic is fully preserved, including the fix of `if amount_cents` to `if amount_cents is not None`. The API version string '2026-01-28.clover' appears fabricated but is structurally valid. Overall this is high-quality code with only minor idiomatic concerns.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "stripe\\.PaymentIntent\\.create",
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.4,
              "contamination_detected": true
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code correctly migrates from the legacy global-state Stripe pattern to the new StripeClient pattern in Python. It uses `StripeClient(api_key=..., stripe_version=...)` correctly, calls `client.payment_intents.create(params={...})` and `client.refunds.create(params=...)` which matches the Python StripeClient SDK's idiomatic usage. The business logic is fully preserved including the conditional partial refund amount check (improved with `is not None`). The wrapping in a class with type hints and docstrings is a quality improvement over the original.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": false
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [
                "2026-01-28\\.clover"
              ],
              "expected_hit_count": 3,
              "expected_total": 4,
              "expected_hit_rate": 0.75,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.2,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 4,
              "contamination_signals": [
                "The StripeClient API calling convention `self.client.v1.payment_intents.create(params=params, options=options)` may not exactly match the current Python SDK's actual method signatures \u2014 the Python SDK StripeClient uses keyword arguments directly rather than a `params` dict in some versions, though this pattern has been documented in newer SDK versions",
                "The API version '2026-01-28.clover' is fictitious and not a real Stripe API version, suggesting potential hallucination rather than cross-language contamination"
              ],
              "brief_assessment": "The code is entirely valid Python with good structure, type hints, docstrings, and comprehensive error handling. It correctly migrates to the StripeClient pattern and preserves the original business logic (charge_customer and refund_payment). The `params=params, options=options` calling convention for the StripeClient methods is close to the documented Python SDK pattern but may vary depending on the exact SDK version \u2014 some SDK versions accept keyword arguments directly. The fabricated API version string ('2026-01-28.clover') is a minor concern but doesn't reflect cross-language contamination. The addition of idempotency keys and error handling goes beyond the original task but is a reasonable enhancement. The refund logic correctly uses `is not None` instead of the original truthiness check, which is actually an improvement.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": false
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [
                "The `params={}` dict-wrapping pattern resembles the Node.js/TypeScript stripe SDK more than the Python SDK, where the Python StripeClient typically accepts keyword arguments directly or uses a slightly different param passing convention",
                "The API version '2026-01-28.clover' appears fabricated \u2014 not a real Stripe API version"
              ],
              "brief_assessment": "The code is entirely valid Python with good type hints, docstrings, and use of environment variables. The migration to StripeClient with `client.v1.payment_intents.create()` and `client.v1.refunds.create()` is directionally correct for the newer stripe-python SDK pattern. However, the `params={}` dict-wrapping style is slightly more reminiscent of the Node.js SDK convention than the typical Python SDK usage (where named parameters are passed as keyword arguments to `create()`). The fix of `if amount_cents` to `if amount_cents is not None` is a genuine improvement. The fabricated API version string is a minor concern but doesn't affect functional correctness.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "stripe\\.PaymentIntent\\.create",
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.4,
              "contamination_detected": true
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code correctly migrates from the legacy global stripe module pattern to the new StripeClient pattern in Python. The use of `StripeClient`, `self.client.payment_intents.create(params={...})`, and `self.client.refunds.create(params=params)` follows the documented Python SDK pattern. The `stripe_version` constructor parameter is correct. One minor note: the new StripeClient Python SDK typically accepts `params` as a dict argument, which is exactly what's done here. The code also improves upon the original by fixing the truthy check (`if amount_cents` \u2192 `if amount_cents is not None`), wrapping everything in a well-documented class with type hints, and preserving all business logic faithfully.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": false
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [
                "2026-01-28\\.clover"
              ],
              "expected_hit_count": 3,
              "expected_total": 4,
              "expected_hit_rate": 0.75,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.2,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Python with no cross-language contamination. It correctly migrates from the legacy global `stripe` module pattern to the new `StripeClient` pattern, using `self.client.v1.payment_intents.create(params={...}, options={...})` which aligns with the modern stripe-python SDK's StripeClient interface. The business logic is fully preserved \u2014 both `charge_customer` and `refund_payment` are faithfully translated. The code adds valuable improvements like idempotency keys, type hints, comprehensive error handling, and a clean class-based structure. The only minor note is the use of a fabricated API version string ('2026-01-28.clover'), but this doesn't affect the pattern correctness. The `params`/`options` keyword argument style is consistent with the newer Python SDK's StripeClient API.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.2,
              "contamination_detected": true
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [
                "The `params={}` keyword argument pattern in `client.v1.payment_intents.create(params={...})` is reminiscent of other SDK patterns; the Python stripe library's StripeClient actually accepts parameters as direct keyword arguments or as a dict positional argument, not necessarily as `params=` keyword \u2014 though recent versions do support `params` as a named parameter, making this borderline"
              ],
              "brief_assessment": "The code is entirely valid Python with excellent structure, type hints, logging, error handling, and docstrings. The migration to StripeClient with `client.v1.payment_intents.create()` and `client.v1.refunds.create()` is largely correct for the modern stripe-python SDK. The use of `params=` as a keyword argument is supported in recent versions of the SDK but is slightly atypical compared to the more common pattern of passing a dict directly. The fabricated API version '2026-01-28.clover' is a minor concern but doesn't affect functional correctness. The refund function also improves the original by checking `is not None` instead of just truthiness, which is actually a bug fix for zero-amount edge cases. Overall, this is high-quality production-ready code.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "StripeClient",
                  "matched": true
                },
                {
                  "pattern": "2026-01-28\\.clover",
                  "matched": true
                },
                {
                  "pattern": "payment_intents\\.create|v1\\.payment_intents\\.create",
                  "matched": true
                },
                {
                  "pattern": "refunds\\.create|v1\\.refunds\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "StripeClient",
                "2026-01-28\\.clover",
                "payment_intents\\.create|v1\\.payment_intents\\.create",
                "refunds\\.create|v1\\.refunds\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 4,
              "expected_total": 4,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.PaymentIntent\\.create",
                  "matched": true
                },
                {
                  "pattern": "stripe\\.Refund\\.create",
                  "matched": false
                },
                {
                  "pattern": "2024-12-18\\.acacia",
                  "matched": true
                },
                {
                  "pattern": "require\\(['\"]stripe['\"]\\)",
                  "matched": false
                },
                {
                  "pattern": "Stripe::PaymentIntent",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "stripe\\.PaymentIntent\\.create",
                "2024-12-18\\.acacia"
              ],
              "anti_pattern_hit_count": 2,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.4,
              "contamination_detected": true
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-07",
      "task_type": "adjacent_domain",
      "target_language": "javascript",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely correct JavaScript/Node.js with no foreign language patterns. It uses the Stripe Node.js SDK idiomatically \u2014 `stripe.accounts.create()`, `stripe.accountLinks.create()`, and `stripe.accounts.retrieve()` are all correct API calls with proper parameter naming (snake_case for Stripe API fields, camelCase for JS variables). The module fully accomplishes the task: it creates an Express account with card_payments and transfers capabilities, generates an onboarding link, and includes helpful extras like account status retrieval and link refreshing. The code is well-structured with JSDoc comments, proper error handling, and a clean module export pattern.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in JavaScript with idiomatic Node.js patterns (async/await, class-based module, require). The Stripe API usage is correct and idiomatic for the stripe npm package \u2014 accounts.create with type 'express', capabilities with requested: true, and accountLinks.create are all properly used. The code accomplishes the core task (create Express account, request card_payments/transfers capabilities, generate onboarding link) and adds useful extras like status checking and a combined workflow. The code is truncated at the end (updateAccount and _handleStripeError methods are cut off), which slightly impacts completeness and quality. The API version '2026-01-28.clover' is fictional/futuristic but the prompt asked for 'current' version, which is a minor issue.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [
                "The API version string '2026-01-28.clover' appears fabricated/hallucinated - not a real Stripe API version, though the task asked for 'current' version which is ambiguous"
              ],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js using ES module syntax with the correct Stripe Node.js SDK patterns. All API calls (accounts.create, accountLinks.create, accounts.retrieve, accounts.createLoginLink) use the correct idiomatic Node.js Stripe SDK interface. The module fully accomplishes the task \u2014 creating an Express account with card_payments and transfers capabilities and generating an onboarding link \u2014 and goes beyond by providing helpful utility functions. The only notable issue is the hallucinated API version string, which would likely cause an error at runtime, though the structure of passing apiVersion in the constructor is correct.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in idiomatic Node.js JavaScript using the correct Stripe Node.js SDK (`stripe` npm package). All API calls\u2014`stripe.accounts.create`, `stripe.accountLinks.create`, `stripe.accounts.retrieve`\u2014use the correct method signatures and parameter names (snake_case as expected by the Stripe Node SDK). The module fully accomplishes the task: it creates an Express account with `card_payments` and `transfers` capabilities requested, generates an onboarding account link, and provides helpful utility functions. The code is well-structured, properly documented with JSDoc, includes error handling, and follows a clean modular pattern. The usage example is slightly truncated but this does not affect the module itself.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely correct JavaScript/Node.js with idiomatic Stripe Node SDK usage. It properly creates an Express account with card_payments and transfers capabilities, then generates an onboarding account link. The API calls (stripe.accounts.create, stripe.accountLinks.create) use the correct Node.js SDK patterns with proper parameters. The output is slightly truncated at the example function's console.log, and the API version string '2026-01-28.clover' appears fabricated (likely a future or hallucinated version), but the code structure and functionality are solid. The retry logic and helper functions add good production-quality touches, though the console.log statements in library code are a minor quality concern.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js using ES module syntax. It uses the Stripe Node.js SDK idiomatically \u2014 stripe.accounts.create(), stripe.accountLinks.create(), and stripe.accounts.createLoginLink() are all correct API calls with proper parameter structures. The code fully accomplishes the task: creates an Express account with card_payments and transfers capabilities, and generates an onboarding link. The only minor note is the API version string '2026-01-28.clover' appears to be a fabricated future version, but this is a cosmetic issue and doesn't affect correctness. Code quality is excellent with JSDoc, error handling, clean structure, and helpful utility functions beyond the minimum requirements.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely in idiomatic Node.js JavaScript, using the correct stripe npm package API with proper snake_case parameter names matching the Stripe Node.js SDK (e.g., refresh_url, return_url, card_payments, business_type). It fully accomplishes all three requested tasks: creating an Express account, requesting card_payments and transfers capabilities, and generating an onboarding link. The module is well-structured with JSDoc comments, proper error handling, helpful utility functions (checkAccountStatus, refreshOnboardingLink), and clean module.exports \u2014 production-quality code.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 5,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js with no foreign language patterns. It correctly uses the Stripe Node.js SDK idiomatically \u2014 stripe.accounts.create(), stripe.accountLinks.create(), stripe.accounts.del(), etc. are all correct API calls. The code accomplishes the core task (create Express account with card_payments/transfers capabilities, generate onboarding link) but the handleStripeError function is truncated mid-line, which is a completeness issue. The API version '2026-01-28.clover' appears fabricated (a future date), but the code structure and patterns are otherwise solid and well-documented.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 5,
              "code_quality": 5,
              "contamination_signals": [
                "The API version string '2026-01-28.clover' appears fabricated/hallucinated \u2014 no such Stripe API version exists as of current knowledge, though the task asked for 'current' version"
              ],
              "brief_assessment": "The code is entirely valid JavaScript/Node.js using ES module syntax. It correctly uses the Stripe Node.js SDK to create an Express account with card_payments and transfers capabilities, then generates an onboarding account link \u2014 fully accomplishing the stated task. The API usage is idiomatic for the stripe npm package with proper async/await patterns, error handling, and well-structured return objects. The only notable issue is the hallucinated API version string, which would cause an error at runtime if Stripe rejects unknown versions; otherwise this is production-quality code with good JSDoc, bonus utility functions, and clear documentation.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "accounts\\.create",
                  "matched": true
                },
                {
                  "pattern": "capabilities",
                  "matched": true
                },
                {
                  "pattern": "card_payments",
                  "matched": true
                },
                {
                  "pattern": "transfers",
                  "matched": true
                },
                {
                  "pattern": "requested:\\s*true",
                  "matched": true
                },
                {
                  "pattern": "accountLinks\\.create|account_links\\.create",
                  "matched": true
                }
              ],
              "expected_hits": [
                "accounts\\.create",
                "capabilities",
                "card_payments",
                "transfers",
                "requested:\\s*true",
                "accountLinks\\.create|account_links\\.create"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.api_version\\s*=",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "Stripe::Account",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.Account\\.create",
                  "matched": false
                },
                {
                  "pattern": "create_account",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 5,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    },
    {
      "task_id": "upgrade-stripe-comprehensive-08",
      "task_type": "adjacent_domain",
      "target_language": "ruby",
      "runs": [
        {
          "run_index": 0,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with no foreign language patterns. The Stripe Billing MeterEvent API usage is largely correct \u2014 `Stripe::Billing::MeterEvent.create` with `event_name`, `payload` (including `stripe_customer_id` and `value`), and `timestamp` matches the Ruby SDK. Minor concerns: `event.identifier` and `event.created` may not be the exact attribute names on the MeterEvent response object (the actual response attributes may differ slightly), and converting `value` to a string is a minor deviation. Overall the code is well-structured, thoroughly documented, includes comprehensive error handling, and would accomplish the stated task.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": true
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "Billing::MeterEvent\\.create\\("
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.16666666666666666,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The StripeClient instantiation pattern `Stripe::StripeClient.new(api_key, stripe_version: ...)` and the chained method call `@client.v1.billing.meter_events.create(...)` follow the newer Stripe Ruby SDK thin-client pattern, but the `stripe_version: '2026-01-28.clover'` is a fabricated/hallucinated API version that doesn't exist",
                "The `meter_event.identifier` attribute access is suspect \u2014 the Stripe Ruby SDK meter event object typically uses `id` not `identifier`, which may be a pattern borrowed from another SDK or hallucinated",
                "Passing idempotency_key as a second hash argument to `create` via the client pattern may not match the exact Ruby SDK interface for the thin client; the standard pattern uses `Stripe::Billing::MeterEvent.create()` with `idempotency_key` in opts"
              ],
              "brief_assessment": "The code is well-structured, entirely in Ruby, and demonstrates solid error handling with retry logic and input validation. However, it uses a potentially incorrect or hallucinated API version ('2026-01-28.clover'), and the StripeClient thin-client pattern (`@client.v1.billing.meter_events.create`) may not precisely match the actual Ruby SDK interface \u2014 the more established idiomatic approach uses `Stripe::Billing::MeterEvent.create`. The code is also truncated at the end (cut off mid-method), losing a small portion of functionality. Overall it demonstrates good Ruby practices but has API idiomaticity concerns.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "client.v1.billing.meter_events.create() uses a chained client pattern that resembles the newer Python/Node Stripe SDK patterns rather than the standard Ruby SDK pattern (Stripe::Billing::MeterEvent.create)",
                "StripeClient instantiation with positional API key and stripe_version keyword follows the Python SDK's new client pattern more than the traditional Ruby gem usage",
                "event.identifier is not a standard Ruby Stripe SDK attribute name - the Ruby SDK typically uses event.id",
                "The API version '2026-01-28.clover' is a fabricated future version, though the Ruby stripe gem does accept api_version strings"
              ],
              "brief_assessment": "The code is syntactically valid Ruby with good structure, error handling, and logging. However, the Stripe API usage shows contamination from the Python/Node SDK patterns \u2014 specifically the `client.v1.billing.meter_events.create()` chained method style and `StripeClient` instantiation pattern, which differ from the idiomatic Ruby gem approach of `Stripe::Billing::MeterEvent.create()`. The reliance on `ApplicationService`, `ServiceResult`, and `with_error_handling` assumes custom framework infrastructure not part of the task requirements, though the overall architecture is clean and well-organized.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": false
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [
                "Stripe::Billing::MeterEvent"
              ],
              "expected_hit_count": 5,
              "expected_total": 6,
              "expected_hit_rate": 0.8333333333333334,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 1,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with idiomatic patterns (keyword arguments, custom exceptions, structured return hashes). The Stripe API usage is largely correct \u2014 `Stripe::Billing::MeterEvent.create` with `event_name`, `payload`, and `timestamp` matches the current Ruby SDK. Minor concerns: `event.identifier` may not be the correct attribute name (it could be `event.id` or `event.identifier` depending on the exact API response shape), and converting `value` to a string may not be necessary. The code is well-structured with thorough error handling, input validation, and clear documentation, making it production-quality.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": true
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "Billing::MeterEvent\\.create\\("
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.16666666666666666,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [
                "StripeClient constructor signature `Stripe::StripeClient.new(api_key, stripe_version: ...)` does not match the Ruby SDK's actual constructor which takes keyword arguments or a config block",
                "The `@client.v1.billing.meter_events.create(params, options)` pattern resembles the newer thin client / Python-style SDK pattern; the standard Ruby SDK uses `Stripe::Billing::MeterEvent.create(params, options)` as a class method",
                "Accessing `error.request_id` directly on certain error types and `event.identifier` may reflect patterns from other SDK languages (e.g., Python or Node) rather than idiomatic Ruby Stripe gem usage",
                "The API version string '2026-01-28.clover' is a fabricated future version, possibly hallucinated"
              ],
              "brief_assessment": "The code is clean, well-structured Ruby with excellent error handling, retry logic, validation, and documentation. However, the Stripe API usage shows contamination from the newer Python/Node-style thin client pattern (`@client.v1.billing.meter_events.create`) rather than the standard Ruby SDK approach (`Stripe::Billing::MeterEvent.create`). The StripeClient constructor signature and the fabricated API version also indicate confusion across SDK languages. Despite these API issues, the overall logic and structure would accomplish the task if the correct Ruby SDK methods were used.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 4,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The StripeClient instantiation pattern with positional secret key argument and stripe_version keyword is not standard for the Ruby SDK - the Ruby gem typically uses Stripe.api_key and Stripe.api_version globals or passes config differently",
                "The @stripe_client.v1.billing.meter_events.create chained method pattern resembles the newer Python/Java SDK thin client pattern more than idiomatic Ruby SDK usage",
                "The API version string '2026-01-28.clover' is a fabricated future version, not an actual current Stripe API version",
                "ApplicationService and ServiceResult are custom framework patterns not part of standard Ruby or Rails - while not contamination per se, they add assumed dependencies"
              ],
              "brief_assessment": "The code is valid Ruby with good structure, error handling, and logging. However, the Stripe API usage shows contamination from other language SDKs - particularly the `@stripe_client.v1.billing.meter_events.create` call chain which mirrors the newer Python/Java thin client pattern rather than idiomatic Ruby SDK usage (which would typically use `Stripe::Billing::MeterEvent.create`). The StripeClient instantiation with a positional API key argument also doesn't match the Ruby gem's typical configuration pattern. The fabricated API version string is also concerning. Functionally, the code would accomplish the task if the API calls were corrected.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": false
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [
                "Stripe::Billing::MeterEvent"
              ],
              "expected_hit_count": 5,
              "expected_total": 6,
              "expected_hit_rate": 0.8333333333333334,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        },
        {
          "run_index": 2,
          "baseline": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 5,
              "contamination_signals": [
                "value field passed as string via .to_s - this may reflect Python SDK conventions where values are sometimes stringified, though it's not clearly wrong",
                "meter_event.identifier is not a documented attribute - the MeterEvent object may not have this field; meter_event.id would be more standard"
              ],
              "brief_assessment": "The code is entirely valid Ruby with no foreign language syntax. It correctly uses Stripe::Billing::MeterEvent.create which is the proper Ruby SDK class for the current Stripe API. The structure, error handling, input validation, batch processing, and documentation are all excellent and production-quality. Minor concerns: `meter_event.identifier` is likely not the correct attribute name (should probably be `meter_event.id` or just omitted), and converting `value` to a string may not be necessary in the Ruby SDK. The `timestamp` parameter being explicitly set is fine but optional. Overall this is a well-structured, thorough implementation that would work with minor adjustments.",
              "cached": true
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": true
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [
                "Billing::MeterEvent\\.create\\("
              ],
              "anti_pattern_hit_count": 1,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.16666666666666666,
              "contamination_detected": true
            }
          },
          "with_skill": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 4,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [],
              "brief_assessment": "The code is entirely valid Ruby with proper idiomatic patterns (keyword arguments, YARD docs, frozen_string_literal). The Stripe API usage with `@client.v1.billing.meter_events.create` follows the newer StripeClient-based SDK pattern correctly. The `identifier` field in `build_event_params` is not a standard Stripe MeterEvent parameter (idempotency is handled separately via headers), and `metadata` inside `payload` is also questionable. The code is truncated at the end (cut off mid-method in `handle_invalid_request_error`), losing the final error handler methods and the class closing `end`. The API version string '2026-01-28.clover' appears fabricated but isn't a contamination issue. Overall solid Ruby code with good structure, though the truncation prevents full scoring.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": true
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "Stripe::Billing::MeterEvent",
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [],
              "expected_hit_count": 6,
              "expected_total": 6,
              "expected_hit_rate": 1.0,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          },
          "skill_md_only": null,
          "realistic": {
            "judge": {
              "language_correctness": 5,
              "api_idiomaticity": 3,
              "functional_correctness": 4,
              "code_quality": 4,
              "contamination_signals": [
                "The StripeClient v1 method chaining pattern (`@stripe_client.v1.billing.meter_events.create`) resembles the newer Python/Node SDK thin client pattern rather than the established Ruby gem's class-method API (`Stripe::Billing::MeterEvent.create`)",
                "The `stripe_version` keyword argument in StripeClient constructor and the API version string '2026-01-28.clover' appear fabricated/futuristic and don't match any real Stripe Ruby SDK initialization pattern",
                "Using `event.identifier` to access the event ID is not a documented Stripe Ruby gem attribute \u2014 the standard would be `event.id`"
              ],
              "brief_assessment": "The code is syntactically valid Ruby and follows reasonable Rails service-object conventions with solid error handling and input validation. However, the Stripe API usage shows contamination from newer Python/Node SDK patterns: the `StripeClient` instantiation with `stripe_version`, the `v1.billing.meter_events.create` chained call style, and `event.identifier` are not how the current Stripe Ruby gem works (which uses `Stripe::Billing::MeterEvent.create` class methods). The fabricated API version string further undermines confidence. The code would need adjustment to actually work against the real Stripe Ruby SDK.",
              "cached": false
            },
            "patterns": {
              "expected_results": [
                {
                  "pattern": "Stripe::Billing::MeterEvent",
                  "matched": false
                },
                {
                  "pattern": "event_name",
                  "matched": true
                },
                {
                  "pattern": "api_tokens_used",
                  "matched": true
                },
                {
                  "pattern": "payload",
                  "matched": true
                },
                {
                  "pattern": "stripe_customer_id",
                  "matched": true
                },
                {
                  "pattern": "class\\s+\\w+",
                  "matched": true
                }
              ],
              "expected_hits": [
                "event_name",
                "api_tokens_used",
                "payload",
                "stripe_customer_id",
                "class\\s+\\w+"
              ],
              "expected_misses": [
                "Stripe::Billing::MeterEvent"
              ],
              "expected_hit_count": 5,
              "expected_total": 6,
              "expected_hit_rate": 0.8333333333333334,
              "anti_results": [
                {
                  "pattern": "stripe\\.billing\\.meter_events",
                  "matched": false
                },
                {
                  "pattern": "stripe\\.billing\\.meterEvents",
                  "matched": false
                },
                {
                  "pattern": "Billing::MeterEvent\\.create\\(",
                  "matched": false
                },
                {
                  "pattern": "import stripe",
                  "matched": false
                },
                {
                  "pattern": "const stripe",
                  "matched": false
                },
                {
                  "pattern": "create_usage_record",
                  "matched": false
                }
              ],
              "anti_pattern_hits": [],
              "anti_pattern_hit_count": 0,
              "anti_pattern_total": 6,
              "anti_pattern_hit_rate": 0.0,
              "contamination_detected": false
            }
          }
        }
      ]
    }
  ]
}